{"name":"empower-core","description":"Power Assert feature enhancer for assert function/object","version":"1.2.0","author":{"name":"Takuto Wada","email":"takuto.wada@gmail.com","url":"https://github.com/twada"},"bugs":{"url":"https://github.com/twada/power-assert-runtime/issues"},"contributors":[{"name":"James Talmage","url":"https://github.com/jamestalmage"}],"dependencies":{"call-signature":"0.0.2","core-js":"^2.0.0"},"devDependencies":{"acorn":"^5.0.0","acorn-es7-plugin":"^1.0.14","buster-assertions":"^0.10.4","escodegen":"^1.8.0","espower":"^2.0.0","mocha":"^5.0.0"},"directories":{"lib":"./lib"},"files":["CHANGELOG.md","README.md","index.js","lib","package.json"],"homepage":"https://github.com/twada/power-assert-runtime","keywords":["assert","assertion","power-assert","test","testing"],"license":"MIT","main":"./index.js","repository":{"type":"git","url":"git+https://github.com/twada/power-assert-runtime.git"},"scripts":{"test":"mocha test"},"readme":"empower-core\n================================\n\n[![power-assert][power-assert-banner]][power-assert-url]\n\n[![Build Status][travis-image]][travis-url]\n[![NPM package][npm-image]][npm-url]\n[![License][license-image]][license-url]\n\n\nPower Assert feature enhancer for assert function/object.\n\n\nDESCRIPTION\n---------------------------------------\n`empower-core` is a core module of [power-assert](https://github.com/power-assert-js/power-assert) family. `empower-core` enhances standard `assert` function or any assert-like object to work with power-assert feature added code instrumented by [espower](https://github.com/power-assert-js/espower).\n\n\n`empower-core` works with standard `assert` function (best fit with [Mocha](https://mochajs.org/)), and also supports assert-like objects/functions provided by various testing frameworks such as [QUnit](https://qunitjs.com/), [buster.js](http://docs.busterjs.org/en/latest/), and [nodeunit](https://github.com/caolan/nodeunit).\n\n\nPull-requests, issue reports and patches are always welcomed. See [power-assert](https://github.com/power-assert-js/power-assert) project for more documentation.\n\n\nCHANGELOG\n---------------------------------------\nSee [CHANGELOG](https://github.com/twada/power-assert-runtime/packages/empower-core/blob/master/CHANGELOG.md)\n\n\nAPI\n---------------------------------------\n\n### var enhancedAssert = empowerCore(originalAssert, [options])\n\n| return type            |\n|:-----------------------|\n| `function` or `object` |\n\n`empower-core` function takes function or object(`originalAssert`) then returns PowerAssert feature added function/object based on `originalAssert`.\nIf `destructive` option is falsy, `originalAssert` will be unchanged. If `destructive` option is truthy, `originalAssert` will be manipulated directly and returned `enhancedAssert` will be the same instance of `originalAssert`.\n\n\n#### originalAssert\n\n| type                   | default value |\n|:-----------------------|:--------------|\n| `function` or `object` | N/A           |\n\n`originalAssert` is an instance of standard `assert` function or any assert-like object. see [SUPPORTED ASSERTION LIBRARIES](https://github.com/twada/power-assert-runtime/packages/empower-core#supported-assertion-libraries) and [ASSERTION LIBRARIES KNOWN TO WORK](https://github.com/twada/power-assert-runtime/packages/empower-core#assertion-libraries-known-to-work) section. Be careful that `originalAssert` will be manipulated directly if `destructive` option is truthy.\n\n\n#### options\n\n| type     | default value |\n|:---------|:--------------|\n| `object` | (return value of `empowerCore.defaultOptions()`) |\n\nConfiguration options. If not passed, default options will be used.\n\n\n#### options.destructive\n\n| type      | default value |\n|:----------|:--------------|\n| `boolean` | `false`       |\n\nIf truthy, modify `originalAssert` destructively.\n\nIf `false`, empower-core mimics originalAssert as new object/function, so `originalAssert` will not be changed. If `true`, `originalAssert` will be manipulated directly and returned `enhancedAssert` will be the same instance of `originalAssert`.\n\n\n#### options.bindReceiver\n\n| type      | default value |\n|:----------|:--------------|\n| `boolean` | `true`        |\n\n`bindReceiver` defaults to `true`, meaning assertion methods have their `this` value bound to the original assertion. Setting `bindReceiver` to false causes the `this` reference to be passed through from the actual invocation.\n\n\n#### options.onError\n#### options.onSuccess\n\n| type       | default value |\n|:-----------|:--------------|\n| `function` | (function defined in `empowerCore.defaultOptions()`) |\n\nBoth methods are called with a single `event` argument, it will have the following properties:\n\n- `event.enhanced` - `true` for methods matching `patterns`. `false` for methods matching `wrapOnlyPatterns`.\n\n- `event.originalMessage` - The actual value the user provided for optional `message` parameter. This will be `undefined` if the user did not provide a value, even if the underlying assertion provides a default message.\n\n- `event.defaultMessage` - If you use objects instead of strings to specify patterns (see below), the `defaultMessage` metadata will be copied directly on the event object.\n\n- `event.matcherSpec` - This contains the complete parsed matcher spec as supplied, as well as any additional metadata you may have supplied (see patterns section below for details on how to supply additional metadata).\n\n- `event.args` - An array of the actual arguments passed to the assertion.\n\n- `event.assertionThrew` - Whether or not the underlying assertion threw an error. This will always be `true` in an `onError` callback, and always `false` in an `onSuccess` callback.\n\n- `event.error` - Only present if `event.assertionThrew === true`. Contains the error thrown by the underlying assertion method.\n\n- `event.returnValue` - Only present if `event.assertionThrew === false`. Contains the value return value returned by the underlying assertion method.\n\n- `event.powerAssertContext` - Only present for methods that match `patterns`, and only in code that has been enhanced with the power-assert transform. It contains the information necessary for power-assert renderers to generate their output. Implementors of `onError` should usually attach it to the error object\n\n  ```js\n  function onError (errorEvent) {\n    var e = errorEvent.error;\n    if (errorEvent.powerAssertContext && /^AssertionError/.test(e.name)) {\n        e.powerAssertContext = errorEvent.powerAssertContext;\n    }\n    throw e;\n  }\n  ```\n\n#### options.modifyMessageBeforeAssert\n\n| type       | default value |\n|:-----------|:--------------|\n| `function` | N/A           |\n\nTBD\n\n\n#### options.patterns\n\n| type                | default value       |\n|:--------------------|:--------------------|\n| `Array` of `string` or `objects`| objects shown below |\n\n```javascript\n[\n    'assert(value, [message])',\n    'assert.ok(value, [message])',\n    'assert.equal(actual, expected, [message])',\n    'assert.notEqual(actual, expected, [message])',\n    'assert.strictEqual(actual, expected, [message])',\n    'assert.notStrictEqual(actual, expected, [message])',\n    'assert.deepEqual(actual, expected, [message])',\n    'assert.notDeepEqual(actual, expected, [message])',\n    'assert.deepStrictEqual(actual, expected, [message])',\n    'assert.notDeepStrictEqual(actual, expected, [message])'\n]\n```\nTarget patterns for power assert feature instrumentation.\n\nPattern detection is done by [call-signature](https://github.com/jamestalmage/call-signature). Any arguments enclosed in bracket (for example, `[message]`) means optional parameters. Without bracket means mandatory parameters.\n\nInstead of a string, you may alternatively specify an object with a `pattern` property, and any other arbitrary data.\nCurrently only `defaultMessage` is formally recommended, but you can attach any data here and it will be passed to the `onSuccess` and `onError` handlers.\n\n```javascript\n[\n  {\n    pattern: 'assert.fail([message])',\n    defaultMessage:'assert.fail() was called!!'\n  },\n  ...\n]\n```\n\n#### options.wrapOnlyPatterns\n\n| type                | default value       |\n|:--------------------|:--------------------|\n| `Array` of `string` | empty array         |\n\nMethods matching these patterns will not be instrumented by the code transform, but they will be wrapped at runtime and trigger events in the `onSuccess` and `onError` callbacks. Note that \"wrap only\" events will never have a `powerAssertContext` property.\n\nSimilar to the `options.patterns`, you may supply objects with a `pattern` member, and the additional metadata will be passed to the assertion listeners.\n\n### var options = empowerCore.defaultOptions();\n\nReturns default options object for `empowerCore` function. In other words, returns\n\n```javascript\n{\n    destructive: false,\n    onError: onError,\n    onSuccess: onSuccess,\n    patterns: [\n        'assert(value, [message])',\n        'assert.ok(value, [message])',\n        'assert.equal(actual, expected, [message])',\n        'assert.notEqual(actual, expected, [message])',\n        'assert.strictEqual(actual, expected, [message])',\n        'assert.notStrictEqual(actual, expected, [message])',\n        'assert.deepEqual(actual, expected, [message])',\n        'assert.notDeepEqual(actual, expected, [message])',\n        'assert.deepStrictEqual(actual, expected, [message])',\n        'assert.notDeepStrictEqual(actual, expected, [message])'\n    ]\n}\n```\n\nwith sensible default for `onError` and `onSuccess`\n\n```js\nfunction onError (errorEvent) {\n    var e = errorEvent.error;\n    if (errorEvent.powerAssertContext && e.name === 'AssertionError') {\n        e.powerAssertContext = errorEvent.powerAssertContext;\n    }\n    throw e;\n}\n\nfunction onSuccess(successEvent) {\n    return successEvent.returnValue;\n}\n```\n\n\nSUPPORTED ASSERTION LIBRARIES\n---------------------------------------\n* [Node assert API](https://nodejs.org/api/assert.html)\n\n\nASSERTION LIBRARIES KNOWN TO WORK\n---------------------------------------\n* [QUnit.assert](https://qunitjs.com/)\n* [nodeunit](https://github.com/caolan/nodeunit)\n* [buster-assertions](http://docs.busterjs.org/en/latest/modules/buster-assertions/)\n\n\nINSTALL\n---------------------------------------\n\n### via npm\n\nInstall\n\n    $ npm install --save-dev empower-core\n\n\n#### use empower-core npm module on browser\n\n`empowerCore` function is exported\n\n    <script type=\"text/javascript\" src=\"./path/to/node_modules/empower-core/build/empower-core.js\"></script>\n\n\n### via bower\n\nInstall\n\n    $ bower install --save-dev empower-core\n\nThen load (`empowerCore` function is exported)\n\n    <script type=\"text/javascript\" src=\"./path/to/bower_components/empower-core/build/empower-core.js\"></script>\n\n\nOUR SUPPORT POLICY\n---------------------------------------\n\nWe support Node under maintenance. In other words, we stop supporting old Node version when [their maintenance ends](https://github.com/nodejs/LTS).\n\nWe also support \"modern enough\" browsers such as Chrome, Firefox, Safari, Edge etc.\n\nAny other environments are not supported officially (means that we do not test against them on CI service). empower-core is known to work with old browsers, and trying to keep them working though.\n\n\nAUTHOR\n---------------------------------------\n* [Takuto Wada](https://github.com/twada)\n\n\nCONTRIBUTORS\n---------------------------------------\n* [James Talmage (jamestalmage)](https://github.com/jamestalmage)\n\n\nLICENSE\n---------------------------------------\nLicensed under the [MIT](https://github.com/twada/power-assert-runtime/blob/master/LICENSE) license.\n\n\n[power-assert-url]: https://github.com/power-assert-js/power-assert\n[power-assert-banner]: https://raw.githubusercontent.com/power-assert-js/power-assert-js-logo/master/banner/banner-official-fullcolor.png\n\n[travis-url]: https://travis-ci.org/twada/power-assert-runtime\n[travis-image]: https://secure.travis-ci.org/twada/power-assert-runtime.svg?branch=master\n\n[npm-url]: https://npmjs.org/package/empower-core\n[npm-image]: https://badge.fury.io/js/empower-core.svg\n\n[license-url]: https://github.com/twada/power-assert-runtime/blob/master/LICENSE\n[license-image]: https://img.shields.io/badge/license-MIT-brightgreen.svg\n","readmeFilename":"README.md","_id":"empower-core@1.2.0","_shasum":"ce3fb2484d5187fa29c23fba8344b0b2fdf5601c","_resolved":"https://registry.npmjs.org/empower-core/-/empower-core-1.2.0.tgz","_from":"https://registry.npmjs.org/empower-core/-/empower-core-1.2.0.tgz"}